import json
import pandas as pd

# Define the features you're interested in
features = [
    'getcommandlinea', 'getstartupinfoa', 'lockresource', 'getprocaddress',
    'getcurrentthreadid', 'virtualallocex', 'getsystemdirectorya', 'getversionexa',
    'getmodulehandlea', 'gettickcount', 'gettickcount.1', 'loadresource', 
    'loadlibrarya', 'freelibrary', 'findclose', 'readfile', 'createprocessa',
    'getcurrentprocess', 'createthread', 'raiseexception', 'createremotethread',
    'createfilea', 'getwindowsdirectorya', 'createmutexa', 'isdebuggerpresent',
    'callnexthookex', 'setwindowshookexa'
]

# Load the JSON file
with open('report_1.json', 'r') as file:
    data = json.load(file)

# Initialize a dictionary to store the presence of each feature
extracted_features = {feature: 0 for feature in features}

# Check if each feature is present in the data
for feature in features:
    if feature in str(data).lower():  # Convert JSON to string and check
        extracted_features[feature] = 1

# Convert the dictionary to a DataFrame
df = pd.DataFrame([extracted_features])

print(df)
